/*! grapesjs-dinvitations - 1.0.2 */
!function(t,e){'object'==typeof exports&&'object'==typeof module?module.exports=e():'function'==typeof define&&define.amd?define([],e):'object'==typeof exports?exports["grapesjs-dinvitations"]=e():t["grapesjs-dinvitations"]=e()}('undefined'!=typeof globalThis?globalThis:'undefined'!=typeof window?window:this,()=>(()=>{"use strict";var t={d:(e,o)=>{for(var s in o)t.o(o,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:o[s]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(t,'__esModule',{value:!0})}},e={};t.r(e),t.d(e,{default:()=>a});const o=function(t){const e=t.DomComponents;e.addType("background-video",{extend:"default",model:{defaults:{tagName:"div",draggable:!0,droppable:!0,attributes:{class:"background-video-wrapper"},provider:"html5",muted:!0,components:[],styles:`\n          .background-video-wrapper {\n            position: relative;\n            width: 100%;\n            height: 0;\n            padding-bottom: 56.25%;\n            overflow: hidden;\n          }\n          .background-video-wrapper iframe,\n          .background-video-wrapper video {\n            position: absolute;\n            top: 0; left: 0;\n            width: 100%;\n            height: 100%;\n            object-fit: cover;\n          }\n        `,traits:[{type:"text",name:"overlayId",label:"Overlay ID",changeProp:1},{type:"select",name:"provider",label:"Video Provider",changeProp:1,options:[{value:"html5",name:"Uploaded Video"},{value:"youtube",name:"YouTube"},{value:"youtube-nocookie",name:"YouTube (No Cookie)"},{value:"vimeo",name:"Vimeo"}]},{type:"file-asset",label:"Upload Video",name:"video-src",changeProp:1},{type:"text",name:"embed-src",label:"Embed ID",changeProp:1},{type:"color",label:"Overlay Color",name:"overlay-color",changeProp:1},{type:"checkbox",name:"muted",label:"Mute Video",valueTrue:!0,valueFalse:!1,changeProp:1}]},init(){if(!this.get("overlayId")){const t=`video-overlay-${Date.now()}-${Math.floor(1e3*Math.random())}`;this.set("overlayId",t)}this.listenTo(this,"change:provider",this.updateProvider),this.listenTo(this,"change:video-src",this.updateHtml5Src),this.listenTo(this,"change:embed-src",this.updateEmbedSrc),this.listenTo(this,"change:overlay-color",this.updateOverlayColor),this.listenTo(this,"change:muted",this.updateMuted),this.updateProvider()},updateProvider(){const t=this.get("provider"),e=this.get("components"),o=this.get("overlayId"),s=e.find(t=>t.getAttributes().id===o);let n;if(e.filter(t=>{const e=t.get("tagName");return"video"===e||"iframe"===e}).forEach(t=>e.remove(t)),"html5"===t)n={tagName:"video",type:"video",attributes:{autoplay:!0,loop:!0,muted:this.get("muted"),playsinline:!0,controls:!1,src:this.get("video-src")||"",style:"width:100%; height:100%; object-fit:cover;"},draggable:!1};else{const e=this.get("embed-src")||"",o=this.get("muted")?1:0;let s="";"youtube"===t?s=`https://www.youtube.com/embed/${e}?autoplay=1&mute=${o}&loop=1&playlist=${e}`:"youtube-nocookie"===t?s=`https://www.youtube-nocookie.com/embed/${e}?autoplay=1&mute=${o}&loop=1&playlist=${e}`:"vimeo"===t&&(s=`https://player.vimeo.com/video/${e}?autoplay=1&muted=${o}&loop=1&background=1`),n={tagName:"iframe",attributes:{src:s,frameborder:0,allow:"autoplay; fullscreen",allowfullscreen:!0,style:"width:100%; height:100%;"},draggable:!1}}const a=s?e.indexOf(s):e.length;e.add(n,{at:a}),this.updateOverlayColor()},updateHtml5Src(){if("html5"!==this.get("provider"))return;const t=this.get("components").find(t=>"video"===t.get("tagName"));t&&t.set("src",this.get("video-src"))},updateEmbedSrc(){"html5"!==this.get("provider")&&this.updateProvider()},updateOverlayColor(){const t=this.get("components"),e=this.get("overlayId"),o=this.get("overlay-color")||"rgba(0,0,0,0.3)";let s=t.find(t=>t.getAttributes().id===e);if(!s){const n=this.addOverlayComponent(o);t.add(n),s=t.find(t=>t.getAttributes().id===e)}const n=s.getStyle()||{};s.setStyle({...n,background:o})},addOverlayComponent(t){return{tagName:"div",attributes:{id:this.get("overlayId"),class:"video-overlay"},style:{position:"absolute",top:"0",left:"0",right:"0",bottom:"0",background:t},draggable:!1}},updateMuted(){if("html5"===this.get("provider")){const t=this.get("components").find(t=>"video"===t.get("tagName"));t&&t.set("muted",this.get("muted"))}else this.updateProvider()}}}),e.addType("rsvp-buttons",{model:{defaults:{tagName:"div",draggable:!0,droppable:!0,traits:[{name:"rsvp",type:"select",label:"RSVP State",options:[{id:"null",name:"No Response"},{id:"true",name:"Attending"},{id:"false",name:"Not Attending"}],changeProp:1},{name:"rsvp-endpoint",label:"Submit Endpoint",value:"/rsvp",placeholder:"/rsvp",changeProp:1}],rsvp:"null",attributes:{"data-rsvp":"null","data-rsvp-endpoint":"/rsvp"},components:[{tagName:"div",classes:["rsvp-thank-you-wrapper"],attributes:{"data-rsvp-visible":"true,false"},components:[{type:"text",content:"Thank you for confirming your attendance.",classes:["rsvp-thank-you"],editable:!0},{type:"button",text:"Change RSVP",classes:["btn-rsvp-change"]}]},{tagName:"div",classes:["rsvp-buttons-wrapper"],attributes:{"data-rsvp-visible":"null"},components:[{type:"button",text:"Yes",classes:["btn-rsvp-yes"]},{type:"button",text:"No",classes:["btn-rsvp-no"]}]}],script:function(){const t=this;function e(e){[...t.children].forEach(t=>{const o=t.getAttribute("data-rsvp-visible");if(!o)return;const s=o.split(",").includes(e);t.style.display=s?"":"none"})}function o(o){const s=t.getAttribute("data-guest-id")||document.querySelector("[data-guest-id]")?.getAttribute("data-guest-id"),n=t.getAttribute("data-rsvp-endpoint")||"/rsvp",a=t.getAttribute("data-rsvp-block-id");s&&fetch(n,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.content},body:JSON.stringify({rsvp:o,guest_id:s,block_id:a})}).then(t=>{if(!t.ok)throw new Error("Submission failed");return t.json()}).then(()=>function(o){const s=String(o);t.setAttribute("data-rsvp",s),e(s)}(o)).catch(t=>{console.error("RSVP error:",t)})}e(String(t.getAttribute("data-rsvp")));const s=t.querySelector(".btn-rsvp-yes"),n=t.querySelector(".btn-rsvp-no"),a=t.querySelector(".btn-rsvp-change");s&&(s.onclick=()=>o(!0)),n&&(n.onclick=()=>o(!1)),a&&(a.onclick=()=>o(null))}},init(){this.listenTo(this,"change:rsvp",()=>{const t=String(this.get("rsvp"));this.addAttributes({"data-rsvp":t}),this.trigger("change:script")}),this.listenTo(this,"change:rsvp-endpoint",()=>{const t=this.get("rsvp-endpoint");this.addAttributes({"data-rsvp-endpoint":t}),this.trigger("change:script")})}}})},s=t=>{t.TraitManager.addType("file-asset",{createInput(){const e=document.createElement("div"),o=document.createElement("input");o.setAttribute("type","text"),o.value=this.model.get("value")||"";const s=document.createElement("button");return s.innerHTML="Choose Video",s.type="button",s.className="gjs-file-asset-btn",s.style="margin-left: 5px;",s.addEventListener("click",()=>{const e=this.target;e&&t.AssetManager.open({types:['video'],accept:'video/*',select(t){const o=t.get("src");e.set("video-src",o),e.addAttributes({"video-src":o}),e.view&&e.view.render()}})}),e.appendChild(o),e.appendChild(s),this.inputEl=o,e},onUpdate(){const t=this.model.get("value")||"";this.inputEl&&(this.inputEl.value=t)},onEvent(){if(!this.inputEl)return;const t=this.inputEl.value.trim();this.model.set("value",t),this.target.set("video-src",t),this.target.addAttributes({"video-src":t})}})},n={'grapesjs-dinvitations':{}},a=function(t){const e={i18n:{},...arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}};s(t),o(t,e),(t=>{const e=t.BlockManager;e.add("background-video",{label:"Background Video",category:"Basic",media:`\n      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">\n        <path d="M2.5,4.5H21.5C22.34,4.5 23,5.15 23,6V17.5C23,18.35 22.34,19 21.5,19H2.5C1.65,19 1,18.35 1,17.5V6C1,5.15 1.65,4.5 2.5,4.5M9.71,8.5V15L15.42,11.7L9.71,8.5M17.25,21H6.65C6.35,21 6.15,20.8 6.15,20.5C6.15,20.2 6.35,20 6.65,20H17.35C17.65,20 17.85,20.2 17.85,20.5C17.85,20.8 17.55,21 17.25,21Z" />\n      </svg>\n    `,content:{type:"background-video"},select:!0,activate:!0}),e.add("rsvp-buttons",{label:"RSVP Buttons",category:"DInvitations",media:`\n      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">\n        <path d="M6,1V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3H18V1H16V3H8V1H6M5,8H19V19H5V8M12.19,9C11.32,9 10.62,9.2 10.08,9.59C9.56,10 9.3,10.57 9.31,11.36L9.32,11.39H11.25C11.26,11.09 11.35,10.86 11.53,10.7C11.71,10.55 11.93,10.47 12.19,10.47C12.5,10.47 12.76,10.57 12.94,10.75C13.12,10.94 13.2,11.2 13.2,11.5C13.2,11.82 13.13,12.09 12.97,12.32C12.83,12.55 12.62,12.75 12.36,12.91C11.85,13.25 11.5,13.55 11.31,13.82C11.11,14.08 11,14.5 11,15H13C13,14.69 13.04,14.44 13.13,14.26C13.22,14.08 13.39,13.9 13.64,13.74C14.09,13.5 14.46,13.21 14.75,12.81C15.04,12.41 15.19,12 15.19,11.5C15.19,10.74 14.92,10.13 14.38,9.68C13.85,9.23 13.12,9 12.19,9M11,16V18H13V16H11Z" />\n      </svg>\n    `,content:()=>({type:"rsvp-buttons",attributes:{"data-rsvp-block-id":`${Date.now()}-${Math.floor(1e3*Math.random())}`}}),select:!0,activate:!0}),e.add("guest-name",{label:"Guest Name",category:"DInvitations",media:`\n      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">\n        <path d="M18 2H12V9L9.5 7.5L7 9V2H6A2 2 0 0 0 4 4V20A2 2 0 0 0 6 22H18A2 2 0 0 0 20 20V4A2 2 0 0 0 18 2M14 12A2 2 0 1 1 12 14A2 2 0 0 1 14 12M18 20H10V19C10 17.67 12.67 17 14 17S18 17.67 18 19Z" />\n      </svg>\n    `,content:{type:"text",content:"Guest Name",attributes:{class:"guest_name"}}}),e.add("guest-qrcode",{label:"QR Code",category:"DInvitations",media:`\n      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">\n        <path d="M3,11H5V13H3V11M11,5H13V9H11V5M9,11H13V15H11V13H9V11M15,11H17V13H19V11H21V13H19V15H21V19H19V21H17V19H13V21H11V17H15V15H17V13H15V11M19,19V15H17V19H19M15,3H21V9H15V3M17,5V7H19V5H17M3,3H9V9H3V3M5,5V7H7V5H5M3,15H9V21H3V15M5,17V19H7V17H5Z" />\n      </svg>\n    `,content:{tagName:"img",type:"image",attributes:{class:"qr_code"}}}),e.add("event-date",{label:"Event Date",category:"DInvitations",media:`\n      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">\n        <path d="M6 1V3H5C3.89 3 3 3.89 3 5V19C3 20.11 3.9 21 5 21H19C20.11 21 21 20.11 21 19V5C21 3.9 20.11 3 19 3H18V1H16V3H8V1H6M5 8H19V19H5V8M11 9V14H13V9H11M11 16V18H13V16H11Z" />\n      </svg>\n    `,content:{type:"text",content:"Event Date",attributes:{class:"event_date"}}}),e.add("address",{label:"Address",category:"DInvitations",media:`\n      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">\n        <path d="M12 2C8.13 2 5 5.13 5 9C5 14.25 12 22 12 22S19 14.25 19 9C19 5.13 15.87 2 12 2M12 11.5C10.62 11.5 9.5 10.38 9.5 9S10.62 6.5 12 6.5 14.5 7.62 14.5 9 13.38 11.5 12 11.5Z" />\n      </svg>\n    `,content:{type:"text",content:"Address",attributes:{class:"address"}}}),e.add("location-link",{label:"Location Link",category:"DInvitations",media:`\n      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">\n        <path d="M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8M3.05,13H1V11H3.05C3.5,6.83 6.83,3.5 11,3.05V1H13V3.05C17.17,3.5 20.5,6.83 20.95,11H23V13H20.95C20.5,17.17 17.17,20.5 13,20.95V23H11V20.95C6.83,20.5 3.5,17.17 3.05,13M12,5A7,7 0 0,0 5,12A7,7 0 0,0 12,19A7,7 0 0,0 19,12A7,7 0 0,0 12,5Z" />\n      </svg>\n    `,content:{tagName:"a",type:"link",content:"Open Maps",attributes:{target:"_blank",class:"location_link"}}})})(t),t.I18n&&t.I18n.addMessages({en:n,...e.i18n}),t.on("load",()=>{try{const e=t.Panels;t.Commands.add("canvas-clear",()=>{confirm("Are you sure to clean the canvas?")&&(t.runCommand("core:canvas-clear"),setTimeout(()=>localStorage.clear(),0))});const o=[["open-sm","Style Manager"],["open-layers","Layers"],["open-blocks","Blocks"]];[["sw-visibility","Show Borders"],["preview","Preview"],["fullscreen","Fullscreen"],["export-template","Export"],["undo","Undo"],["redo","Redo"],["gjs-open-import-webpage","Import"],["canvas-clear","Clear canvas"]].forEach(t=>{let[o,s]=t;const n=e.getButton("options",o);n&&n.set("attributes",{title:s,"data-tooltip-pos":"bottom"})}),o.forEach(t=>{let[o,s]=t;const n=e.getButton("views",o);n&&n.set("attributes",{title:s,"data-tooltip-pos":"bottom"})}),document.querySelectorAll("*[title]").forEach(t=>{const e=t.getAttribute("title")?.trim();e&&(t.setAttribute("data-tooltip",e),t.setAttribute("title",""))}),e.getButton("options","sw-visibility")?.set({command:"core:component-outline",active:!0}),e.getButton("views","open-tm")?.set("active",1),e.getButton("views","open-sm")?.set("active",1),e.removeButton("views","open-tm");const s=document.querySelector(".gjs-sm-sectors"),n=document.querySelector(".gjs-traits-cs");if(s&&n){const t=document.createElement("div");t.className="gjs-sm-sector no-select",t.innerHTML=`\n                <div class="gjs-sm-sector-title">\n                  <span class="icon-settings fa fa-cog"></span>\n                  <span class="gjs-sm-sector-label">Settings</span>\n                </div>\n                <div class="gjs-sm-properties" style="display: none;"></div>\n              `;const e=t.querySelector(".gjs-sm-properties");e.appendChild(n),s.parentNode.insertBefore(t,s),t.querySelector(".gjs-sm-sector-title").addEventListener("click",()=>{const t=e.style;t.display="none"===t.display?"block":"none"})}e.getButton("views","open-blocks")?.set("active",1)}catch(t){console.error("Editor load error:",t)}})};return e})());
//# sourceMappingURL=index.js.map